<!DOCTYPE html>
<!--This comment should only show up on Oliver branch-->
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.12.4.js"></script>
    <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
  </head>
  <body>
    <!-- Start of navbar -->
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <div class="container-fluid">
          <a href="#" class="navbar-brand">PFAS</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar_supported_content">
            <span class="navbar-toggler-icon"></span>
          </button>
  
          <div class="collapse navbar-collapse" id="navbar_supported_content">
            <ul class="navbar-nav ms-auto mb-2 mb-md-0">
              <!-- Home -->
              <li class="nav-item active">
                <a class="nav-link text-white" href="#">Home</a>
              </li>
              
              <!-- About Us Dropdown -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-white" href="#" id="about_dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">About Us</a>
                <ul class="dropdown-menu" aria-labelledby="about_dropdown">
                  <li><a class="dropdown-item" href="#">What are PFAS?</a></li>
                  <li><a class="dropdown-item" href="#">Our Team</a></li>
                  <li><a class="dropdown-item" href="#">Our Partners</a></li>
                  <li><a class="dropdown-item" href="#">Contact Us</a></li>
                </ul>
              </li>
              
              <!-- Publications & Presentations Dropdown -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-white" href="#" id="publication_dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Publications &amp; Presentations</a>
                <ul class="dropdown-menu" aria-labelledby="publication_dropdown">
                  <li><a class="dropdown-item" href="#">2022 Third National PFAS Conference</a></li>
                  <li><a class="dropdown-item" href="#">2019 National PFAS Conference</a></li>
                </ul>
              </li>
              
              <!-- PFAS Sites & Community Resources -->
              <li class="nav-item">
                <a class="nav-link text-white" href="#">PFAS Sites &amp; Community Resources</a>
              </li>
            </ul>
  
            <!-- Search Form
            <form class="form-inline d-flex">
              <input class="form-control mr-sm-2" type="search" placeholder="Search Site" aria-label="Search">
              <button class="btn btn-outline-light my-2 my-sm-0" type="submit">Search</button>
            </form> -->
          </div>
        </div>
    </nav>
      <!-- End of navbar -->
        
        <!--start of container-->
        <div class="container-fluid border">
        <row class="row">
            <!--dropdown start-->
            <div class="col-3 pt-3" style="background-color: rgb(203, 201, 201);">
                <div class="row justify-content-around align-items-center">
                    <div class="col">
                        <div class="accordion" id="advanced-search">
                           <!--start of accordion item-->
                           <!--State or federal agency-->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingOne">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#advSearch1" aria-expanded="false" aria-controls="advSearch1">
                                    State or Federal Agency
                                    </button>
                                    <div id="advSearch1" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="advanced-search">
                                        <div class="accordion-body">
                                            <form class="form-check">
                                                <label class="form-check-label" for="state">
                                                    State
                                                </label>
                                                <input class="form-check-input" type="checkbox" value="" id="state">
                                                <select class="selectpicker" data-width="fit" multiple id="stateSelect" data-selected-text-format="count" data-actions-box="true">
                                                    <!--state options-->
                                                </select>
                                            </form>
                                            <form class="form-check">
                                                <label class="form-check-label" for="federal">
                                                    Federal
                                                </label>
                                                <input class="form-check-input" type="checkbox" value="" id="federal">
                                                <select class="selectpicker" data-width="fit" multiple id="fedSelect" data-selected-text-format="count" data-actions-box="true">
                                                    <!--federal options-->
                                                </select>
                                            </form>
                                        </div>
                                    </div>
                            </div>
                            
                            <!--end of accordion item-->

                            <!--start of accordion item-->
                            <!--Date-->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingTwo">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#advOption2" aria-expanded="false" aria-controls="advOption2">
                                    Date
                                    </button>
                                    <div id="advOption2" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="advanced-search">
                                        <div class="accordion-body justify-content-center">
                                            <form>
                                                <input type="number" min="1900" max="2099" step="1" value="1990" id="dateStart"/>
                                                -
                                                <input type="number" min="1900" max="2099" step="1" value="2023" id="dateEnd"/>
                                            </form>
                                        </div>
                                    </div>
                            </div>
                            <!--end of accordion item-->

                            <!--start of accordion item-->
                            <!--Type of action-->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingThree">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#advOption3" aria-expanded="false" aria-controls="advOption3">
                                    Type of Action
                                    </button>
                                    <div id="advOption3" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="advanced-search">
                                        <div class="accordion-body" id="actionTypeBody">
                                            <!--action types injected here-->
                                        </div>
                                    </div>
                            </div>
                            <!--end of accordion item-->

                            <!--start of accordion item-->
                            <!--Topic of action-->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingFour">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#option4" aria-expanded="false" aria-controls="option4">
                                    Topic of action
                                    </button>
                                    <div id="option4" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="advanced-search">
                                        <div class="accordion-body" id="actionTopicBody">
                                            <!--action topics injected here-->
                                        </div>
                                    </div>
                            </div>
                            <!--end of accordion item-->
                            <!--start of accordion item-->
                            <!--sort by options-->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingFive">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#option5" aria-expanded="false" aria-controls="option5">
                                    Sort by
                                    </button>
                                    <div id="option5" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="advanced-search">
                                        <div class="accordion-body" id="sort-by">
                                            <!-- s<button class="sort asc">sort by title</button> -->
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            <!--dropdown end-->
            
            <!--search bar and cards start-->
            <div class="col-9 pt-2" style="background-color: rgb(203, 201, 201) ;">
                <div class="row g-0 m-0 p-0">
                    <div class="col-11">
    
                   <!--search bar -->
                    <form class="d-flex" role="search">
                        <input class="form-control me-2" type="search" id="target" placeholder="Search" aria-label="Search">
                        <button class="btn btn-secondary" type="submit" id="submitBtn">Search</button>
                    </form> 
                    </div>  
                </div>
                <div class="row">
                    <div class="col-lg-12 gy-2 overflow-auto" id="search_results">  
                    </div>
                </div>
            <!--sear bar and cards end-->
            </div> 
        <!--end of container--> 

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>    <script>
        const name = document.getElementById("name");
        const email = document.getElementById("email");
        const ID = document.getElementById("id");
        const submitBtn = document.getElementById("submitBtn");
        const baseURL = "http://localhost:9001/info";
        var target = "";
        var accordionID = 0;
        const actionType = [
            "AFFF",
            "Agriculture",
            "Air",
            "Alternatives Assessment",
            "Appropriations-omnibus",
            "Chemical ban/substitution",
            "Clean-up and disposal",
            "Data/research requirement",
            "Definition",
            "Drinking water",
            "Food packaging",
            "Funding mechanism",
            "Groundwater",
            "Hazardous Designation",
            "Investigative orders",
            "Litigation",
            "Local/state testing",
            "Medical",
            "Multi-Toxics-omnibus",
            "PFAS Task force",
            "PFAS-omnibus",
            "Permitting process",
            "Product ban/restriction",
            "Reporting requirement",
            "Sludge",
            "Soil/leachate",
            "Standards-setting"
            ];
        const actionTopics = [
        "Legislation",
        "Regulation",
        "Non-regulatory",
        "Peri-governmental"
        ];
        const states = [
        "Alabama",
        "Alaska",
        "Arizona",
        "Arkansas",
        "California",
        "Colorado",
        "Connecticut",
        "Delaware",
        "District of Columbia",
        "Florida",
        "Georgia",
        "Guam",
        "Hawaii",
        "Idaho",
        "Illinois",
        "Indiana",
        "Iowa",
        "Kansas",
        "Kentuky",
        "Louisiana",
        "Maine",
        "Maryland",
        "Massachusetts",
        "Michigan",
        "Minnesota",
        "Mississippi",
        "Missouri",
        "Montana",
        "Nationwide",
        "Nebraska",
        "Nevada",
        "New Hampshire",
        "New Jersey",
        "New Mexico",
        "New York",
        "North Carolina",
        "North Dakota",
        "Northern Mariana Islands",
        "Ohio",
        "Oklahoma",
        "Oregon",
        "Pennsylvania",
        "Puerto Rico",
        "Rhode Island",
        "South Carolina",
        "South Dakota",
        "Tennessee",
        "Texas",
        "U.S. Virgin Islands",
        "Utah",
        "Vermont",
        "Virginia",
        "Washington",
        "West Virginia",
        "Wisconsin",
        "Wyoming"
        ]
        const federal = [
        
        ]
        const stateSel = document.getElementById("state");
        const fedSel = document.getElementById("federal");
        var stateSelVal = $('#stateSelect').val(); // default vaules for search
        var fedSelVal = $('#fedSelect').val();
        var dateStart = $('#dateStart').val();
        var dateEnd = $('#dateEnd').val();
        var actionTypeVal = [];
        var actionTopicVal = [];

        $("#stateSelect").empty();

        $("#fedSelect").empty();

        states.map((item) =>{
            $("#stateSelect").append(
                "<option>" + item + "</option>"
            )
        });

        federal.map((item) =>{
            $("#fedSelect").append(
                "<option>" + item + "</option>"
            )
        });


        /*
        start of event listeners
        */
        $('#stateSelect').on('change',function() {
            stateSelVal = $(this).val();
            console.log(stateSelVal);
        });
        $('#fedSelect').on('change',function() {
            fedSelVal = $(this).val();
            console.log(fedSelVal);
        });
        $('#dateStart').on('change',function() {
            dateStart = $(this).val();
            console.log(dateStart);
        });
        $('#dateEnd').on('change',function() {
            dateEnd = $(this).val();
            console.log(dateEnd);
        });
        /*
        end of event listeners
        */
       
        $("#actionTypeBody").empty();
        actionType.map((item) =>{
            $("#actionTypeBody").append(
                "<form class='form-check'>" +
                "<label class='form-check-label' for='" + item + "'>" +
                    item +
                "</label>" +
                "<input class='form-check-input' type='checkbox' value=' id='" + item + "'>" +
                "</form>"
            )
        });

        $("#actionTopicBody").empty();
        actionTopics.map((item) =>{
            $("#actionTopicBody").append(
                "<form class='form-check'>" +
                "<label class='form-check-label' for='" + item + "'>" +
                    item +
                "</label>" +
                "<input class='form-check-input' type='checkbox' value=' id='" + item + "'>" +
                "</form>"
            )
        });

        $("#target").on("change", function () {
            target = $(this).val();
            console.log(target)
        });

        $("#submitBtn").on("click", getInfo);

        async function getInfo(e) {
            e.preventDefault();
            const searchParams = new URLSearchParams();
            searchParams.append("param1", target); // text search entry
            searchParams.append("param2", stateSelVal)
            searchParams.append("param3", fedSelVal)
            searchParams.append("param4", dateStart)
            searchParams.append("param5", dateEnd)
            searchParams.append("param6", actionTypeVal)
            searchParams.append("param7", actionTopicVal)
            const url = `${baseURL}?${searchParams.toString()}`;

            const res = await fetch(url, { method: "GET" });

            const data = await res.json();
            //console.log(data);
            $("#search_results").empty();
            //console.log(data.data);
            accordionID = 0;
            data.data.map((item) => {
            //console.log(item);
            $("#search_results").append(
                "<div class='card'> " +
                "    <div class='card-body'>" +
                "        <h2 class='card-title ml-3'> " +
                item[1] +
                "<!--***Name of Governance Action/title goes here***-->" +
                "            <!--download button-->" +
                "            <button type='button' class='btn btn-secondary'>" +
                "                <svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-download' viewBox='0 0 16 16'>" +
                "            <path d='M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z'></path>" +
                "            <path d='M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z'></path>" +
                "              </svg>" +
                "              </button>" +
                "        </h2>" +
                "        <!--Actor, Date, Legislation, Topics of Action, and Key Agencies/Players-->" +
                "        <h5 class='card-actor ml-3'>Federal Agency or State: " +
                item[0] +
                "<!--***Name of Federal Agency/State goes here***--></h5>" +
                "        <h5 class='card-date ml-3'>Date: " +
                item[5] +
                "<!--***Date of governance goes here***--></h5>" +
                "        <h5 class='card-type ml-3'>Type of Governance Action: " +
                item[3] +
                "<!--***Type of governance action goes here***--></h5>" +
                "        <h5 class='card-topicsOfAction ml-3'>Topics of Governance Action: " +
                item[4] +
                "<!--***Topics of action goes here***--></h5>" +
                "        <h5 class='card-keyAgencyPlayers ml-3'>Key Agencies and Players: " +
                item[10] +
                "<!--***Key agencies/players goes here***--></h5>" +
                "          <!--Accordion" +
                accordionID +
                " Info Start-->" +
                "          <div class='container mt-4'>" +
                "            <div id='accordion" +
                accordionID +
                "'>" +
                "            <!--Summary of Action-->" +
                "              <div class='card'>" +
                "                <a class='card-link card-header' data-toggle='collapse' href='#collapseOne" +
                accordionID +
                "' >" +
                "                  Summary of Action" +
                "                </a>" +
                "                <div id='collapseOne" +
                accordionID +
                "' class='collapse' data-parent='#accordion" +
                accordionID +
                "'>" +
                "                  <div class='card-body'>" +
                "                    " +
                item[9] +
                "" +
                "                </div>" +
                "              </div>" +
                "              <!--Legislative outcome-->" +
                "              <div class='card'>" +
                "                <a class='card-link card-header' data-toggle='collapse' href='#collapseTwo" +
                accordionID +
                "' >" +
                "                  Legislative Outcome" +
                "                </a>" +
                "                <div id='collapseTwo" +
                accordionID +
                "' class='collapse' data-parent='#accordion" +
                accordionID +
                "'>" +
                "                  <div class='card-body'>" +
                "                    " +
                item[7] +
                "" +
                "                </div>" +
                "              </div>" +
                "              <!--Companion Bills-->" +
                "              <div class='card'>" +
                "                <a class='card-link card-header' data-toggle='collapse' href='#collapseThree" +
                accordionID +
                "' >" +
                "                  Companion Bills" +
                "                </a>" +
                "                <div id='collapseThree" +
                accordionID +
                "' class='collapse' data-parent='#accordion" +
                accordionID +
                "'>" +
                "                  <div class='card-body'>" + item[8]+
                "                    <!--***Companion bills goes here***-->" +
                "                </div>" +
                "              </div>" +
                "              <!--PFAS Definition-->" +
                "              <div class='card'>" +
                "                <a class='collapsed card-link card-header' data-toggle='collapse' href='#collapseFour" +
                accordionID +
                "'>" +
                "                  PFAS Definition" +
                "                </a>" +
                "                <div id='collapseFour" +
                accordionID +
                "' class='collapse' data-parent='#accordion" +
                accordionID +
                "'>" +
                "                  <div class='card-body'>" + item[11]+
                "                    <!--***PFAS definition goes here***-->" +
                "                  </div>" +
                "                </div>" +
                "              </div>" +
                "              <!--Sources-->" +
                "              <div class='card'>" +
                "                <a class='card-link card-header' data-toggle='collapse' href='#collapseFive" +
                accordionID +
                "'>" +
                "                  Sources" +
                "                </a>" +
                "                <div id='collapseFive" +
                accordionID +
                "' class='collapse' data-parent='#accordion" +
                accordionID +
                "'>" +
                "                  <div class='card-body'>" +
                "                    <h6><p>Primary Sources:</p></h6>" +
                "                    <p><a href='"+item[12]+"' class='link-underline-primary' target='_blank'>"+item[12]+"<!--***primary sources links goes here and in href***--></a></p>" +
                "                    <h6><p>Other Impotant Sources:</p></h6>" +
                "                    <p><a href='"+item[13]+"' class='link-underline-primary' target='_blank'>"+item[13]+"<!--***other important sources links goes here and in href***--></a></p>" +
                "                  </div>" +
                "                </div>" +
                "            </div>" +
                "        </div>" +
                "    </div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" 
            ); // html injection can be handled here for each search result
            accordionID++;
            });
        }
        </script>
  </body>
</html>
